function [L,D,L_trans] = chol4X4(A)
L = zeros(4,4);
L_trans = zeros(4,4);
D = zeros(4,4);
D(1,1)=A(1,1);
L(2,1)=A(2,1)/D(1,1);
L(3,1)=A(3,1)/D(1,1);
L(4,1)=A(4,1)/D(1,1);
D(2,2)=A(2,2)-(L(2,1)^2*D(1,1));
L(3,2)=(A(2,3)-(L(3,1)*L(2,1)*D(1,1)))/D(2,2);
L(4,2)=(A(4,2)-(L(4,1)*L(2,1)*D(1,1)))/D(2,2);
D(3,3)=A(3,3)-L(3,1)^2*D(1,1)-L(3,2)^2*D(2,2);
L(4,3)=(A(4,3)-(L(4,1)*L(3,1)*D(1,1))-(L(4,2)*L(3,2)*D(2,2)))/D(3,3);
D(4,4)=A(4,4)-L(4,1)^2*D(1,1)-L(4,2)^2*D(2,2)-L(4,3)^2*D(3,3);

L_trans = L';
end